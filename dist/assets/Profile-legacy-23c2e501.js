System.register(["./index-legacy-525baae1.js","./index-legacy-1cd78d63.js","./index-legacy-899e752b.js"],(function(e,r){"use strict";var n,t,s,c,a,i,u,o,g,l,d,h,p,m,_,w,f,b,$,v,y,k,x,C,I,S,j,L,U,E,P,R,T,q;return{setters:[e=>{n=e.d,t=e.u,s=e.e,c=e.a3,a=e.a,i=e.b6,u=e.ar,o=e.f,g=e.m,l=e.a2,d=e.c0,h=e.c1,p=e.c2,m=e.c3,_=e.a0,w=e.bc,f=e.bf,b=e.c4,$=e.b0,v=e.a_,y=e.I,k=e.F,x=e.B,C=e.t,I=e.aq,S=e.c5,j=e.v,L=e.an,U=e.W,E=e.bx,P=e.bd,R=e.n},e=>{T=e.o},e=>{q=e.L}],execute:function(){const r=e=>o(E,{get colorScheme(){return e.can?"success":"danger"},get children(){return e.children}});e("default",(()=>{const e=n();T("manage.sidemenu.profile");const{to:E,searchParams:B}=t(),[D,F]=s(c().username),[W,z]=s(""),[A,G]=a((e=>i.post("/me/update",{username:e?c().username:D(),password:e?"":W(),sso_id:c().sso_id}))),H=async r=>{const n=await G(r);P(n,(()=>{S({...c(),username:D()}),r?E(""):(R.success(e("users.update_profile_success")),E(`/@login?redirect=${encodeURIComponent(location.pathname)}`))}))};function J(e){const r=e.data;r.sso_id&&(S({...c(),sso_id:r.sso_id}),H(!0))}return window.addEventListener("message",J),u((()=>{window.removeEventListener("message",J)})),o(U,{w:"$full",spacing:"$4",alignItems:"start",get children(){return[o(g,{get when(){return!l.is_guest(c())},get fallback(){return[o(d,{status:"warning",flexDirection:{"@initial":"column","@lg":"row"},get children(){return[o(h,{mr:"$2_5"}),o(p,{mr:"$2_5",get children(){return e("users.guest-tips")}}),o(m,{get children(){return e("users.modify_nothing")}})]}}),o(_,{spacing:"$2",get children(){return[o(w,{get children(){return e("global.have_account")}}),o(w,{color:"$info9",as:q,get href(){return`/@login?redirect=${encodeURIComponent(location.pathname)}`},get children(){return e("global.go_login")}})]}})]},get children(){return[o(f,{get children(){return e("users.update_profile")}}),o(b,{gap:"$2",columns:{"@initial":1,"@md":2},get children(){return[o($,{get children(){return[o(v,{for:"username",get children(){return e("users.change_username")}}),o(y,{id:"username",get value(){return D()},onInput:e=>{F(e.currentTarget.value)}})]}}),o($,{get children(){return[o(v,{for:"password",get children(){return e("users.change_password")}}),o(y,{id:"password",type:"password",placeholder:"********",get value(){return W()},onInput:e=>{z(e.currentTarget.value)}}),o(k,{get children(){return e("users.change_password-tips")}})]}})]}}),o(_,{spacing:"$2",get children(){return[o(x,{get loading(){return A()},onClick:[H,!1],get children(){return e("global.save")}}),o(g,{get when(){return!c().otp},get children(){return o(x,{colorScheme:"accent",onClick:()=>{E("/@manage/2fa")},get children(){return e("users.enable_2fa")}})}})]}})]}}),o(g,{get when(){return C((()=>!!I("sso_login_enabled")))()&&!l.is_guest(c())},get children(){return[o(f,{get children(){return e("users.sso_login")}}),o(_,{spacing:"$2",get children(){return o(g,{get when(){return c().sso_id},get fallback(){return o(x,{onClick:()=>{const e=i.getUri()+"/auth/sso?method=get_sso_id";window.open(e,"authPopup","width=500,height=600")},get children(){return e("users.connect_sso")}})},get children(){return o(x,{colorScheme:"danger",get loading(){return A()},onClick:()=>{S({...c(),sso_id:""}),H(!0)},get children(){return e("users.disconnect_sso")}})}})}})]}}),o(_,{wrap:"wrap",gap:"$2",mt:"$2",get children(){return o(j,{each:L,children:(n,t)=>o(r,{get can(){return l.can(c(),t())},get children(){return e(`users.permissions.${n}`)}})})}})]}})}))}}}));
